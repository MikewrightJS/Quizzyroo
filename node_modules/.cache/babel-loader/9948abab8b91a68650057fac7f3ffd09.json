{"ast":null,"code":"// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE\n'use strict';\n\nvar MemoryStore = require('./memory').MemoryStore;\n\nvar utils = require('./lookup');\n\nvar Lookup = utils.Lookup;\n\nvar util = require('util');\n\nvar Heap = require('binaryheap');\n\nvar MemoryStoreExpire = function (store, zone, opts) {\n  opts = opts || {};\n  this._store = store;\n  this._zone = zone;\n  this._max_keys = opts.max_keys;\n  this._ttl = new Heap(true);\n};\n\nMemoryStoreExpire.prototype.get = function (domain, key, cb) {\n  var self = this;\n\n  this._store.get(domain, key, function (err, results) {\n    var i, j, type, record;\n    var nresults = {};\n    var now = Date.now();\n\n    for (i in results) {\n      type = results[i];\n\n      for (j in type) {\n        record = type[j];\n        record.ttl = Math.round((record._ttl_expires - now) / 1000);\n\n        if (record.ttl > 0) {\n          if (!nresults[i]) {\n            nresults[i] = [];\n          }\n\n          nresults[i].push(record);\n        } else {\n          self._ttl.remove(record);\n\n          self._store.delete(self._zone, record.name, record.type, function () {});\n        }\n      }\n    }\n\n    cb(err, nresults);\n  });\n};\n\nMemoryStoreExpire.prototype.set = function (domain, key, data, cb) {\n  var i, j, type, record, expires;\n  var self = this;\n  var now = Date.now();\n  key = utils.ensure_absolute(key);\n\n  for (i in data) {\n    type = data[i];\n\n    for (j in type) {\n      record = type[j];\n      expires = record.ttl * 1000 + now;\n      record._ttl_expires = expires;\n\n      self._ttl.insert(record, expires);\n    }\n  }\n\n  while (this._ttl.length > this._max_keys) {\n    var record = this._ttl.pop();\n\n    this._store.delete(this._zone, record.name, record.type);\n  }\n\n  this._store.set(domain, key, data, function (err, results) {\n    if (cb) cb(err, results);\n  });\n};\n\nMemoryStoreExpire.prototype.delete = function (domain, key, type, cb) {\n  if (!cb) {\n    cb = type;\n    type = undefined;\n  }\n\n  var self = this;\n\n  this._store.get(domain, utils.ensure_absolute(key), function (gerr, gresults) {\n    var i, j, ktype, record;\n\n    for (i in gresults) {\n      ktype = gresults[i];\n\n      for (j in ktype) {\n        record = ktype[j];\n\n        self._ttl.remove(record);\n      }\n    }\n\n    if (!gresults) {\n      if (cb) cb(gerr, gresults);\n      return;\n    }\n\n    self._store.delete(domain, key, type, function (err, results) {\n      if (cb) cb(err, results);\n    });\n  });\n};\n\nvar Cache = module.exports = function (opts) {\n  opts = opts || {};\n  this._zone = '.' || opts.zone;\n  this._store = undefined;\n\n  this.purge = function () {\n    this._store = new MemoryStoreExpire(opts.store || new MemoryStore(), this._zone, opts);\n  };\n\n  this.purge();\n};\n\nCache.prototype.store = function (packet) {\n  var self = this;\n  var c = {};\n\n  function each(record) {\n    var r = c[record.name.toLowerCase()];\n    var t;\n    if (!r) r = c[record.name.toLowerCase()] = {};\n    t = r[record.type];\n    if (!t) t = r[record.type] = [];\n    t.push(record);\n  }\n\n  packet.answer.forEach(each);\n  packet.authority.forEach(each);\n  packet.additional.forEach(each);\n  Object.keys(c).forEach(function (key) {\n    self._store.set(self._zone, utils.ensure_absolute(key), c[key]);\n  });\n};\n\nCache.prototype.lookup = function (question, cb) {\n  var self = this;\n  Lookup(this._store, this._zone, question, function (err, results) {\n    var i,\n        record,\n        found = false;\n\n    for (i in results) {\n      record = results[i];\n\n      if (record.type == question.type) {\n        found = true;\n        break;\n      }\n    }\n\n    if (results && !found) {\n      self._store.delete(self._zone, utils.ensure_absolute(question.name));\n\n      results.forEach(function (rr) {\n        self._store.delete(self._zone, utils.ensure_absolute(rr.name));\n      });\n      results = null;\n    }\n\n    cb(results);\n  });\n};","map":{"version":3,"sources":["C:/react/quiz/node_modules/native-dns-cache/cache.js"],"names":["MemoryStore","require","utils","Lookup","util","Heap","MemoryStoreExpire","store","zone","opts","_store","_zone","_max_keys","max_keys","_ttl","prototype","get","domain","key","cb","self","err","results","i","j","type","record","nresults","now","Date","ttl","Math","round","_ttl_expires","push","remove","delete","name","set","data","expires","ensure_absolute","insert","length","pop","undefined","gerr","gresults","ktype","Cache","module","exports","purge","packet","c","each","r","toLowerCase","t","answer","forEach","authority","additional","Object","keys","lookup","question","found","rr"],"mappings":"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","sourcesContent":["// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE\n\n'use strict';\n\nvar MemoryStore = require('./memory').MemoryStore;\nvar utils = require('./lookup');\nvar Lookup = utils.Lookup;\nvar util = require('util');\nvar Heap = require('binaryheap');\n\nvar MemoryStoreExpire = function (store, zone, opts) {\n  opts = opts || {};\n  this._store = store;\n  this._zone = zone;\n  this._max_keys = opts.max_keys;\n  this._ttl = new Heap(true);\n};\n\nMemoryStoreExpire.prototype.get = function (domain, key, cb) {\n  var self = this;\n  this._store.get(domain, key, function (err, results) {\n    var i, j, type, record;\n    var nresults = {};\n    var now = Date.now();\n\n    for (i in results) {\n      type = results[i];\n      for (j in type) {\n        record = type[j];\n        record.ttl = Math.round((record._ttl_expires - now) / 1000)\n        if (record.ttl > 0) {\n          if (!nresults[i]) {\n            nresults[i] = [];\n          }\n          nresults[i].push(record);\n        } else {\n          self._ttl.remove(record);\n          self._store.delete(self._zone, record.name, record.type, function () {});\n        }\n      }\n    }\n\n    cb(err, nresults);\n  });\n};\n\nMemoryStoreExpire.prototype.set = function (domain, key, data, cb) {\n  var i, j, type, record, expires;\n  var self = this;\n  var now = Date.now();\n\n  key = utils.ensure_absolute(key);\n\n  for (i in data) {\n    type = data[i];\n    for (j in type) {\n      record = type[j];\n      expires = (record.ttl * 1000) + now;\n      record._ttl_expires = expires;\n      self._ttl.insert(record, expires);\n    }\n  }\n\n  while (this._ttl.length > this._max_keys) {\n    var record = this._ttl.pop();\n    this._store.delete(this._zone, record.name, record.type);\n  }\n\n  this._store.set(domain, key, data, function (err, results) {\n    if (cb)\n      cb(err, results);\n  });\n};\n\nMemoryStoreExpire.prototype.delete = function (domain, key, type, cb) {\n  if (!cb) {\n    cb = type;\n    type = undefined;\n  }\n\n  var self = this;\n\n  this._store.get(domain, utils.ensure_absolute(key), function (gerr, gresults) {\n    var i, j, ktype, record;\n\n    for (i in gresults) {\n      ktype = gresults[i];\n      for (j in ktype) {\n        record = ktype[j];\n        self._ttl.remove(record);\n      }\n    }\n\n    if (!gresults) {\n      if (cb)\n        cb(gerr, gresults);\n      return;\n    }\n\n    self._store.delete(domain, key, type, function (err, results) {\n      if (cb)\n        cb(err, results);\n    });\n  });\n};\n\nvar Cache = module.exports = function (opts) {\n  opts = opts || {};\n  this._zone = '.' || opts.zone;\n  this._store = undefined;\n  this.purge = function () {\n    this._store = new MemoryStoreExpire(opts.store || new MemoryStore(), this._zone, opts);\n  }\n  this.purge();\n};\n\nCache.prototype.store = function (packet) {\n  var self = this;\n  var c = {};\n\n  function each(record) {\n    var r = c[record.name.toLowerCase()];\n    var t;\n\n    if (!r)\n      r = c[record.name.toLowerCase()] = {};\n\n    t = r[record.type];\n\n    if (!t)\n      t = r[record.type] = [];\n\n    t.push(record);\n  }\n\n  packet.answer.forEach(each);\n  packet.authority.forEach(each);\n  packet.additional.forEach(each);  \n\n  Object.keys(c).forEach(function (key) {\n    self._store.set(self._zone, utils.ensure_absolute(key), c[key]);\n  });\n};\n\nCache.prototype.lookup = function (question, cb) {\n  var self = this;\n  Lookup(this._store, this._zone, question, function (err, results) {\n    var i, record, found = false;\n\n    for (i in results) {\n      record = results[i];\n      if (record.type == question.type) {\n        found = true;\n        break;\n      }\n    }\n\n    if (results && !found) {\n      self._store.delete(self._zone, utils.ensure_absolute(question.name));\n      results.forEach(function (rr) {\n        self._store.delete(self._zone, utils.ensure_absolute(rr.name));\n      });\n      results = null;\n    }\n\n    cb(results);\n  });\n};\n"]},"metadata":{},"sourceType":"script"}