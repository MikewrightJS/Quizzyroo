{"ast":null,"code":"// Load modules\nvar Fs = require('fs'); // Declare internals\n\n\nvar internals = {}; // Clone object or array\n\nexports.clone = function (obj) {\n  if (obj === null || obj === undefined) {\n    return null;\n  }\n\n  var newObj = obj instanceof Array ? [] : {};\n\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (obj[i] instanceof Date) {\n        newObj[i] = new Date(obj[i].getTime());\n      } else if (obj[i] instanceof RegExp) {\n        var flags = '' + (obj[i].global ? 'g' : '') + (obj[i].ignoreCase ? 'i' : '') + (obj[i].multiline ? 'm' : '') + (obj[i].sticky ? 'y' : '');\n        newObj[i] = new RegExp(obj[i].source, flags);\n      } else if (typeof obj[i] === 'object') {\n        newObj[i] = exports.clone(obj[i]);\n      } else {\n        newObj[i] = obj[i];\n      }\n    }\n  }\n\n  return newObj;\n}; // Merge all the properties of source into target, source wins in conflic, and by default null and undefined from source are applied\n\n\nexports.merge = function (target, source, isNullOverride\n/* = true */\n, isMergeArrays\n/* = true */\n) {\n  if (source) {\n    if (source instanceof Array) {\n      if (isMergeArrays !== false) {\n        // Defaults to true\n        target = (target || []).concat(source);\n      } else {\n        target = source;\n      }\n    } else {\n      target = target || {};\n\n      for (var key in source) {\n        if (source.hasOwnProperty(key)) {\n          var value = source[key];\n\n          if (value && typeof value === 'object') {\n            if (value instanceof Date) {\n              target[key] = new Date(value.getTime());\n            } else if (value instanceof RegExp) {\n              var flags = '' + (value.global ? 'g' : '') + (value.ignoreCase ? 'i' : '') + (value.multiline ? 'm' : '') + (value.sticky ? 'y' : '');\n              target[key] = new RegExp(value.source, flags);\n            } else {\n              target[key] = exports.merge(target[key], source[key], isNullOverride, isMergeArrays);\n            }\n          } else {\n            if (value !== null && value !== undefined) {\n              // Explicit to preserve empty strings\n              target[key] = value;\n            } else if (isNullOverride !== false) {\n              // Defaults to true\n              target[key] = value;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return target;\n}; // Apply options to a copy of the defaults\n\n\nexports.applyToDefaults = function (defaults, options) {\n  if (!options) {\n    // If no options, return null\n    return null;\n  }\n\n  var copy = exports.clone(defaults);\n\n  if (options === true) {\n    // If options is set to true, use defaults\n    return copy;\n  }\n\n  return exports.merge(copy, options, false, false);\n}; // Remove duplicate items from array\n\n\nexports.unique = function (array, key) {\n  var index = {};\n  var result = [];\n\n  for (var i = 0, il = array.length; i < il; ++i) {\n    var id = key ? array[i][key] : array[i];\n\n    if (index[id] !== true) {\n      result.push(array[i]);\n      index[id] = true;\n    }\n  }\n\n  return result;\n}; // Convert array into object\n\n\nexports.mapToObject = function (array, key) {\n  if (!array) {\n    return null;\n  }\n\n  var obj = {};\n\n  for (var i = 0, il = array.length; i < il; ++i) {\n    if (key) {\n      if (array[i][key]) {\n        obj[array[i][key]] = true;\n      }\n    } else {\n      obj[array[i]] = true;\n    }\n  }\n\n  return obj;\n}; // Find the common unique items in two arrays\n\n\nexports.intersect = function (array1, array2) {\n  if (!array1 || !array2) {\n    return [];\n  }\n\n  var common = [];\n  var hash = exports.mapToObject(array1);\n  var found = {};\n\n  for (var i = 0, il = array2.length; i < il; ++i) {\n    if (hash[array2[i]] && !found[array2[i]]) {\n      common.push(array2[i]);\n      found[array2[i]] = true;\n    }\n  }\n\n  return common;\n}; // Find which keys are present\n\n\nexports.matchKeys = function (obj, keys) {\n  var matched = [];\n\n  for (var i = 0, il = keys.length; i < il; ++i) {\n    if (obj.hasOwnProperty(keys[i])) {\n      matched.push(keys[i]);\n    }\n  }\n\n  return matched;\n}; // Flatten array\n\n\nexports.flatten = function (array, target) {\n  var result = target || [];\n\n  for (var i = 0, il = array.length; i < il; ++i) {\n    if (Array.isArray(array[i])) {\n      exports.flatten(array[i], result);\n    } else {\n      result.push(array[i]);\n    }\n  }\n\n  return result;\n}; // Remove keys\n\n\nexports.removeKeys = function (object, keys) {\n  for (var i = 0, il = keys.length; i < il; i++) {\n    delete object[keys[i]];\n  }\n}; // Convert an object key chain string ('a.b.c') to reference (object[a][b][c])\n\n\nexports.reach = function (obj, chain) {\n  var path = chain.split('.');\n  var ref = obj;\n  path.forEach(function (level) {\n    if (ref) {\n      ref = ref[level];\n    }\n  });\n  return ref;\n}; // Inherits a selected set of methods from an object, wrapping functions in asynchronous syntax and catching errors\n\n\nexports.inheritAsync = function (self, obj, keys) {\n  keys = keys || null;\n\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (keys instanceof Array && keys.indexOf(i) < 0) {\n        continue;\n      }\n\n      self.prototype[i] = function (fn) {\n        return function (callback) {\n          var result = null;\n\n          try {\n            result = fn();\n          } catch (err) {\n            return callback(err);\n          }\n\n          return callback(null, result);\n        };\n      }(obj[i]);\n    }\n  }\n};\n\nexports.callStack = function (slice) {\n  // http://code.google.com/p/v8/wiki/JavaScriptStackTraceApi\n  var v8 = Error.prepareStackTrace;\n\n  Error.prepareStackTrace = function (err, stack) {\n    return stack;\n  };\n\n  var capture = {};\n  Error.captureStackTrace(capture, arguments.callee);\n  var stack = capture.stack;\n  Error.prepareStackTrace = v8;\n  var trace = [];\n  stack.forEach(function (item) {\n    trace.push([item.getFileName(), item.getLineNumber(), item.getColumnNumber(), item.getFunctionName(), item.isConstructor()]);\n  });\n\n  if (slice) {\n    return trace.slice(slice);\n  }\n\n  return trace;\n};\n\nexports.displayStack = function (slice) {\n  var trace = exports.callStack(slice === undefined ? 1 : slice + 1);\n  var display = [];\n  trace.forEach(function (row) {\n    display.push((row[4] ? 'new ' : '') + row[3] + ' (' + row[0] + ':' + row[1] + ':' + row[2] + ')');\n  });\n  return display;\n};\n\nexports.abort = function (message) {\n  if (process.env.NODE_ENV === 'test') {\n    throw new Error(message || 'Unknown error');\n  } else {\n    console.log('ABORT: ' + message + '\\n\\t' + exports.displayStack(1).join('\\n\\t'));\n    process.exit(1);\n  }\n};\n\nexports.assert = function (condition, message) {\n  if (!condition) {\n    exports.abort(message);\n  }\n};\n\nexports.loadDirModules = function (path, excludeFiles, target) {\n  // target(filename, name, capName)\n  var exclude = {};\n\n  for (var i = 0, il = excludeFiles.length; i < il; ++i) {\n    exclude[excludeFiles[i] + '.js'] = true;\n  }\n\n  Fs.readdirSync(path).forEach(function (filename) {\n    if (/\\.js$/.test(filename) && !exclude[filename]) {\n      var name = filename.substr(0, filename.lastIndexOf('.'));\n      var capName = name.charAt(0).toUpperCase() + name.substr(1).toLowerCase();\n\n      if (typeof target !== 'function') {\n        target[capName] = require(path + '/' + name);\n      } else {\n        target(path + '/' + name, name, capName);\n      }\n    }\n  });\n};\n\nexports.rename = function (obj, from, to) {\n  obj[to] = obj[from];\n  delete obj[from];\n};\n\nexports.Timer = function () {\n  this.reset();\n};\n\nexports.Timer.prototype.reset = function () {\n  this.ts = Date.now();\n};\n\nexports.Timer.prototype.elapsed = function () {\n  return Date.now() - this.ts;\n}; // Load and parse package.json process root or given directory\n\n\nexports.loadPackage = function (dir) {\n  var result = {};\n  var filepath = (dir || process.env.PWD) + '/package.json';\n\n  if (Fs.existsSync(filepath)) {\n    try {\n      result = JSON.parse(Fs.readFileSync(filepath));\n    } catch (e) {}\n  }\n\n  return result;\n}; // Escape string for Regex construction\n\n\nexports.escapeRegex = function (string) {\n  // Escape ^$.*+-?=!:|\\/()[]{},\n  return string.replace(/[\\^\\$\\.\\*\\+\\-\\?\\=\\!\\:\\|\\\\\\/\\(\\)\\[\\]\\{\\}\\,]/g, '\\\\$&');\n}; // Return an error as first argument of a callback\n\n\nexports.toss = function (condition\n/*, [message], callback */\n) {\n  var message = arguments.length === 3 ? arguments[1] : '';\n  var callback = arguments.length === 3 ? arguments[2] : arguments[1];\n  var err = message instanceof Error ? message : message ? new Error(message) : condition instanceof Error ? condition : new Error();\n\n  if (condition instanceof Error || !condition) {\n    return callback(err);\n  }\n}; // Base64url (RFC 4648) encode\n\n\nexports.base64urlEncode = function (value) {\n  return new Buffer(value, 'binary').toString('base64').replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\n}; // Base64url (RFC 4648) decode\n\n\nexports.base64urlDecode = function (encoded) {\n  if (encoded && !encoded.match(/^[\\w\\-]*$/)) {\n    return new Error('Invalid character');\n  }\n\n  try {\n    return new Buffer(encoded.replace(/-/g, '+').replace(/:/g, '/'), 'base64').toString('binary');\n  } catch (err) {\n    return err;\n  }\n}; // Escape attribute value for use in HTTP header\n\n\nexports.escapeHeaderAttribute = function (attribute) {\n  return attribute.replace(/\\\\/g, '\\\\\\\\').replace(/\\\"/g, '\\\\\"');\n}; // Escape string for inclusion in HTML\n\n\ninternals.htmlEscaped = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;'\n};\n\nexports.escapeHtml = function (string) {\n  if (!string) {\n    return '';\n  }\n\n  if (/[&<>\"'`]/.test(string) === false) {\n    return string;\n  }\n\n  return string.replace(/[&<>\"'`]/g, function (chr) {\n    return internals.htmlEscaped[chr];\n  });\n};","map":{"version":3,"sources":["C:/react/quiz/node_modules/sntp/node_modules/hoek/lib/index.js"],"names":["Fs","require","internals","exports","clone","obj","undefined","newObj","Array","i","hasOwnProperty","Date","getTime","RegExp","flags","global","ignoreCase","multiline","sticky","source","merge","target","isNullOverride","isMergeArrays","concat","key","value","applyToDefaults","defaults","options","copy","unique","array","index","result","il","length","id","push","mapToObject","intersect","array1","array2","common","hash","found","matchKeys","keys","matched","flatten","isArray","removeKeys","object","reach","chain","path","split","ref","forEach","level","inheritAsync","self","indexOf","prototype","fn","callback","err","callStack","slice","v8","Error","prepareStackTrace","stack","capture","captureStackTrace","arguments","callee","trace","item","getFileName","getLineNumber","getColumnNumber","getFunctionName","isConstructor","displayStack","display","row","abort","message","process","env","NODE_ENV","console","log","join","exit","assert","condition","loadDirModules","excludeFiles","exclude","readdirSync","filename","test","name","substr","lastIndexOf","capName","charAt","toUpperCase","toLowerCase","rename","from","to","Timer","reset","ts","now","elapsed","loadPackage","dir","filepath","PWD","existsSync","JSON","parse","readFileSync","e","escapeRegex","string","replace","toss","base64urlEncode","Buffer","toString","base64urlDecode","encoded","match","escapeHeaderAttribute","attribute","htmlEscaped","escapeHtml","chr"],"mappings":"AAAA;AAEA,IAAIA,EAAE,GAAGC,OAAO,CAAC,IAAD,CAAhB,C,CAGA;;;AAEA,IAAIC,SAAS,GAAG,EAAhB,C,CAGA;;AAEAC,OAAO,CAACC,KAAR,GAAgB,UAAUC,GAAV,EAAe;AAE3B,MAAIA,GAAG,KAAK,IAAR,IACAA,GAAG,KAAKC,SADZ,EACuB;AAEnB,WAAO,IAAP;AACH;;AAED,MAAIC,MAAM,GAAIF,GAAG,YAAYG,KAAhB,GAAyB,EAAzB,GAA8B,EAA3C;;AAEA,OAAK,IAAIC,CAAT,IAAcJ,GAAd,EAAmB;AACf,QAAIA,GAAG,CAACK,cAAJ,CAAmBD,CAAnB,CAAJ,EAA2B;AACvB,UAAIJ,GAAG,CAACI,CAAD,CAAH,YAAkBE,IAAtB,EAA4B;AACxBJ,QAAAA,MAAM,CAACE,CAAD,CAAN,GAAY,IAAIE,IAAJ,CAASN,GAAG,CAACI,CAAD,CAAH,CAAOG,OAAP,EAAT,CAAZ;AACH,OAFD,MAGK,IAAIP,GAAG,CAACI,CAAD,CAAH,YAAkBI,MAAtB,EAA8B;AAC/B,YAAIC,KAAK,GAAG,MAAMT,GAAG,CAACI,CAAD,CAAH,CAAOM,MAAP,GAAgB,GAAhB,GAAsB,EAA5B,KAAmCV,GAAG,CAACI,CAAD,CAAH,CAAOO,UAAP,GAAoB,GAApB,GAA0B,EAA7D,KAAoEX,GAAG,CAACI,CAAD,CAAH,CAAOQ,SAAP,GAAmB,GAAnB,GAAyB,EAA7F,KAAoGZ,GAAG,CAACI,CAAD,CAAH,CAAOS,MAAP,GAAgB,GAAhB,GAAsB,EAA1H,CAAZ;AACAX,QAAAA,MAAM,CAACE,CAAD,CAAN,GAAY,IAAII,MAAJ,CAAWR,GAAG,CAACI,CAAD,CAAH,CAAOU,MAAlB,EAA0BL,KAA1B,CAAZ;AACH,OAHI,MAIA,IAAI,OAAOT,GAAG,CAACI,CAAD,CAAV,KAAkB,QAAtB,EAAgC;AACjCF,QAAAA,MAAM,CAACE,CAAD,CAAN,GAAYN,OAAO,CAACC,KAAR,CAAcC,GAAG,CAACI,CAAD,CAAjB,CAAZ;AACH,OAFI,MAGA;AACDF,QAAAA,MAAM,CAACE,CAAD,CAAN,GAAYJ,GAAG,CAACI,CAAD,CAAf;AACH;AACJ;AACJ;;AAED,SAAOF,MAAP;AACH,CA7BD,C,CAgCA;;;AAEAJ,OAAO,CAACiB,KAAR,GAAgB,UAAUC,MAAV,EAAkBF,MAAlB,EAA0BG;AAAe;AAAzC,EAAuDC;AAAc;AAArE,EAAmF;AAE/F,MAAIJ,MAAJ,EAAY;AACR,QAAIA,MAAM,YAAYX,KAAtB,EAA6B;AACzB,UAAIe,aAAa,KAAK,KAAtB,EAA6B;AAAuC;AAChEF,QAAAA,MAAM,GAAG,CAACA,MAAM,IAAI,EAAX,EAAeG,MAAf,CAAsBL,MAAtB,CAAT;AACH,OAFD,MAGK;AACDE,QAAAA,MAAM,GAAGF,MAAT;AACH;AACJ,KAPD,MAQK;AACDE,MAAAA,MAAM,GAAGA,MAAM,IAAI,EAAnB;;AAEA,WAAK,IAAII,GAAT,IAAgBN,MAAhB,EAAwB;AACpB,YAAIA,MAAM,CAACT,cAAP,CAAsBe,GAAtB,CAAJ,EAAgC;AAC5B,cAAIC,KAAK,GAAGP,MAAM,CAACM,GAAD,CAAlB;;AAEA,cAAIC,KAAK,IACL,OAAOA,KAAP,KAAiB,QADrB,EAC+B;AAE3B,gBAAIA,KAAK,YAAYf,IAArB,EAA2B;AACvBU,cAAAA,MAAM,CAACI,GAAD,CAAN,GAAc,IAAId,IAAJ,CAASe,KAAK,CAACd,OAAN,EAAT,CAAd;AACH,aAFD,MAGK,IAAIc,KAAK,YAAYb,MAArB,EAA6B;AAC9B,kBAAIC,KAAK,GAAG,MAAMY,KAAK,CAACX,MAAN,GAAe,GAAf,GAAqB,EAA3B,KAAkCW,KAAK,CAACV,UAAN,GAAmB,GAAnB,GAAyB,EAA3D,KAAkEU,KAAK,CAACT,SAAN,GAAkB,GAAlB,GAAwB,EAA1F,KAAiGS,KAAK,CAACR,MAAN,GAAe,GAAf,GAAqB,EAAtH,CAAZ;AACAG,cAAAA,MAAM,CAACI,GAAD,CAAN,GAAc,IAAIZ,MAAJ,CAAWa,KAAK,CAACP,MAAjB,EAAyBL,KAAzB,CAAd;AACH,aAHI,MAIA;AACDO,cAAAA,MAAM,CAACI,GAAD,CAAN,GAActB,OAAO,CAACiB,KAAR,CAAcC,MAAM,CAACI,GAAD,CAApB,EAA2BN,MAAM,CAACM,GAAD,CAAjC,EAAwCH,cAAxC,EAAwDC,aAAxD,CAAd;AACH;AACJ,WAbD,MAcK;AACD,gBAAIG,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKpB,SAAhC,EAA2C;AAAa;AACpDe,cAAAA,MAAM,CAACI,GAAD,CAAN,GAAcC,KAAd;AACH,aAFD,MAGK,IAAIJ,cAAc,KAAK,KAAvB,EAA8B;AAAqB;AACpDD,cAAAA,MAAM,CAACI,GAAD,CAAN,GAAcC,KAAd;AACH;AACJ;AACJ;AACJ;AACJ;AACJ;;AAED,SAAOL,MAAP;AACH,CA9CD,C,CAiDA;;;AAEAlB,OAAO,CAACwB,eAAR,GAA0B,UAAUC,QAAV,EAAoBC,OAApB,EAA6B;AAEnD,MAAI,CAACA,OAAL,EAAc;AAAkD;AAC5D,WAAO,IAAP;AACH;;AAED,MAAIC,IAAI,GAAG3B,OAAO,CAACC,KAAR,CAAcwB,QAAd,CAAX;;AAEA,MAAIC,OAAO,KAAK,IAAhB,EAAsB;AAA0C;AAC5D,WAAOC,IAAP;AACH;;AAED,SAAO3B,OAAO,CAACiB,KAAR,CAAcU,IAAd,EAAoBD,OAApB,EAA6B,KAA7B,EAAoC,KAApC,CAAP;AACH,CAbD,C,CAgBA;;;AAEA1B,OAAO,CAAC4B,MAAR,GAAiB,UAAUC,KAAV,EAAiBP,GAAjB,EAAsB;AAEnC,MAAIQ,KAAK,GAAG,EAAZ;AACA,MAAIC,MAAM,GAAG,EAAb;;AAEA,OAAK,IAAIzB,CAAC,GAAG,CAAR,EAAW0B,EAAE,GAAGH,KAAK,CAACI,MAA3B,EAAmC3B,CAAC,GAAG0B,EAAvC,EAA2C,EAAE1B,CAA7C,EAAgD;AAC5C,QAAI4B,EAAE,GAAIZ,GAAG,GAAGO,KAAK,CAACvB,CAAD,CAAL,CAASgB,GAAT,CAAH,GAAmBO,KAAK,CAACvB,CAAD,CAArC;;AACA,QAAIwB,KAAK,CAACI,EAAD,CAAL,KAAc,IAAlB,EAAwB;AAEpBH,MAAAA,MAAM,CAACI,IAAP,CAAYN,KAAK,CAACvB,CAAD,CAAjB;AACAwB,MAAAA,KAAK,CAACI,EAAD,CAAL,GAAY,IAAZ;AACH;AACJ;;AAED,SAAOH,MAAP;AACH,CAfD,C,CAkBA;;;AAEA/B,OAAO,CAACoC,WAAR,GAAsB,UAAUP,KAAV,EAAiBP,GAAjB,EAAsB;AAExC,MAAI,CAACO,KAAL,EAAY;AACR,WAAO,IAAP;AACH;;AAED,MAAI3B,GAAG,GAAG,EAAV;;AACA,OAAK,IAAII,CAAC,GAAG,CAAR,EAAW0B,EAAE,GAAGH,KAAK,CAACI,MAA3B,EAAmC3B,CAAC,GAAG0B,EAAvC,EAA2C,EAAE1B,CAA7C,EAAgD;AAC5C,QAAIgB,GAAJ,EAAS;AACL,UAAIO,KAAK,CAACvB,CAAD,CAAL,CAASgB,GAAT,CAAJ,EAAmB;AACfpB,QAAAA,GAAG,CAAC2B,KAAK,CAACvB,CAAD,CAAL,CAASgB,GAAT,CAAD,CAAH,GAAqB,IAArB;AACH;AACJ,KAJD,MAKK;AACDpB,MAAAA,GAAG,CAAC2B,KAAK,CAACvB,CAAD,CAAN,CAAH,GAAgB,IAAhB;AACH;AACJ;;AAED,SAAOJ,GAAP;AACH,CAnBD,C,CAsBA;;;AAEAF,OAAO,CAACqC,SAAR,GAAoB,UAAUC,MAAV,EAAkBC,MAAlB,EAA0B;AAE1C,MAAI,CAACD,MAAD,IAAW,CAACC,MAAhB,EAAwB;AACpB,WAAO,EAAP;AACH;;AAED,MAAIC,MAAM,GAAG,EAAb;AACA,MAAIC,IAAI,GAAGzC,OAAO,CAACoC,WAAR,CAAoBE,MAApB,CAAX;AACA,MAAII,KAAK,GAAG,EAAZ;;AACA,OAAK,IAAIpC,CAAC,GAAG,CAAR,EAAW0B,EAAE,GAAGO,MAAM,CAACN,MAA5B,EAAoC3B,CAAC,GAAG0B,EAAxC,EAA4C,EAAE1B,CAA9C,EAAiD;AAC7C,QAAImC,IAAI,CAACF,MAAM,CAACjC,CAAD,CAAP,CAAJ,IAAmB,CAACoC,KAAK,CAACH,MAAM,CAACjC,CAAD,CAAP,CAA7B,EAA0C;AACtCkC,MAAAA,MAAM,CAACL,IAAP,CAAYI,MAAM,CAACjC,CAAD,CAAlB;AACAoC,MAAAA,KAAK,CAACH,MAAM,CAACjC,CAAD,CAAP,CAAL,GAAmB,IAAnB;AACH;AACJ;;AAED,SAAOkC,MAAP;AACH,CAjBD,C,CAoBA;;;AAEAxC,OAAO,CAAC2C,SAAR,GAAoB,UAAUzC,GAAV,EAAe0C,IAAf,EAAqB;AAErC,MAAIC,OAAO,GAAG,EAAd;;AACA,OAAK,IAAIvC,CAAC,GAAG,CAAR,EAAW0B,EAAE,GAAGY,IAAI,CAACX,MAA1B,EAAkC3B,CAAC,GAAG0B,EAAtC,EAA0C,EAAE1B,CAA5C,EAA+C;AAC3C,QAAIJ,GAAG,CAACK,cAAJ,CAAmBqC,IAAI,CAACtC,CAAD,CAAvB,CAAJ,EAAiC;AAC7BuC,MAAAA,OAAO,CAACV,IAAR,CAAaS,IAAI,CAACtC,CAAD,CAAjB;AACH;AACJ;;AACD,SAAOuC,OAAP;AACH,CATD,C,CAYA;;;AAEA7C,OAAO,CAAC8C,OAAR,GAAkB,UAAUjB,KAAV,EAAiBX,MAAjB,EAAyB;AAEvC,MAAIa,MAAM,GAAGb,MAAM,IAAI,EAAvB;;AAEA,OAAK,IAAIZ,CAAC,GAAG,CAAR,EAAW0B,EAAE,GAAGH,KAAK,CAACI,MAA3B,EAAmC3B,CAAC,GAAG0B,EAAvC,EAA2C,EAAE1B,CAA7C,EAAgD;AAC5C,QAAID,KAAK,CAAC0C,OAAN,CAAclB,KAAK,CAACvB,CAAD,CAAnB,CAAJ,EAA6B;AACzBN,MAAAA,OAAO,CAAC8C,OAAR,CAAgBjB,KAAK,CAACvB,CAAD,CAArB,EAA0ByB,MAA1B;AACH,KAFD,MAGK;AACDA,MAAAA,MAAM,CAACI,IAAP,CAAYN,KAAK,CAACvB,CAAD,CAAjB;AACH;AACJ;;AAED,SAAOyB,MAAP;AACH,CAdD,C,CAiBA;;;AAEA/B,OAAO,CAACgD,UAAR,GAAqB,UAAUC,MAAV,EAAkBL,IAAlB,EAAwB;AAEzC,OAAK,IAAItC,CAAC,GAAG,CAAR,EAAW0B,EAAE,GAAGY,IAAI,CAACX,MAA1B,EAAkC3B,CAAC,GAAG0B,EAAtC,EAA0C1B,CAAC,EAA3C,EAA+C;AAC3C,WAAO2C,MAAM,CAACL,IAAI,CAACtC,CAAD,CAAL,CAAb;AACH;AACJ,CALD,C,CAQA;;;AAEAN,OAAO,CAACkD,KAAR,GAAgB,UAAUhD,GAAV,EAAeiD,KAAf,EAAsB;AAElC,MAAIC,IAAI,GAAGD,KAAK,CAACE,KAAN,CAAY,GAAZ,CAAX;AACA,MAAIC,GAAG,GAAGpD,GAAV;AACAkD,EAAAA,IAAI,CAACG,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAE1B,QAAIF,GAAJ,EAAS;AACLA,MAAAA,GAAG,GAAGA,GAAG,CAACE,KAAD,CAAT;AACH;AACJ,GALD;AAOA,SAAOF,GAAP;AACH,CAZD,C,CAeA;;;AAEAtD,OAAO,CAACyD,YAAR,GAAuB,UAAUC,IAAV,EAAgBxD,GAAhB,EAAqB0C,IAArB,EAA2B;AAE9CA,EAAAA,IAAI,GAAGA,IAAI,IAAI,IAAf;;AAEA,OAAK,IAAItC,CAAT,IAAcJ,GAAd,EAAmB;AACf,QAAIA,GAAG,CAACK,cAAJ,CAAmBD,CAAnB,CAAJ,EAA2B;AACvB,UAAIsC,IAAI,YAAYvC,KAAhB,IACAuC,IAAI,CAACe,OAAL,CAAarD,CAAb,IAAkB,CADtB,EACyB;AAErB;AACH;;AAEDoD,MAAAA,IAAI,CAACE,SAAL,CAAetD,CAAf,IAAqB,UAAUuD,EAAV,EAAc;AAE/B,eAAO,UAAUC,QAAV,EAAoB;AAEvB,cAAI/B,MAAM,GAAG,IAAb;;AACA,cAAI;AACAA,YAAAA,MAAM,GAAG8B,EAAE,EAAX;AACH,WAFD,CAGA,OAAOE,GAAP,EAAY;AACR,mBAAOD,QAAQ,CAACC,GAAD,CAAf;AACH;;AAED,iBAAOD,QAAQ,CAAC,IAAD,EAAO/B,MAAP,CAAf;AACH,SAXD;AAYH,OAdmB,CAcjB7B,GAAG,CAACI,CAAD,CAdc,CAApB;AAeH;AACJ;AACJ,CA7BD;;AAgCAN,OAAO,CAACgE,SAAR,GAAoB,UAAUC,KAAV,EAAiB;AAEjC;AAEA,MAAIC,EAAE,GAAGC,KAAK,CAACC,iBAAf;;AACAD,EAAAA,KAAK,CAACC,iBAAN,GAA0B,UAAUL,GAAV,EAAeM,KAAf,EAAsB;AAE5C,WAAOA,KAAP;AACH,GAHD;;AAKA,MAAIC,OAAO,GAAG,EAAd;AACAH,EAAAA,KAAK,CAACI,iBAAN,CAAwBD,OAAxB,EAAiCE,SAAS,CAACC,MAA3C;AACA,MAAIJ,KAAK,GAAGC,OAAO,CAACD,KAApB;AAEAF,EAAAA,KAAK,CAACC,iBAAN,GAA0BF,EAA1B;AAEA,MAAIQ,KAAK,GAAG,EAAZ;AACAL,EAAAA,KAAK,CAACd,OAAN,CAAc,UAAUoB,IAAV,EAAgB;AAE1BD,IAAAA,KAAK,CAACvC,IAAN,CAAW,CAACwC,IAAI,CAACC,WAAL,EAAD,EAAqBD,IAAI,CAACE,aAAL,EAArB,EAA2CF,IAAI,CAACG,eAAL,EAA3C,EAAmEH,IAAI,CAACI,eAAL,EAAnE,EAA2FJ,IAAI,CAACK,aAAL,EAA3F,CAAX;AACH,GAHD;;AAKA,MAAIf,KAAJ,EAAW;AACP,WAAOS,KAAK,CAACT,KAAN,CAAYA,KAAZ,CAAP;AACH;;AAED,SAAOS,KAAP;AACH,CA3BD;;AA8BA1E,OAAO,CAACiF,YAAR,GAAuB,UAAUhB,KAAV,EAAiB;AAEpC,MAAIS,KAAK,GAAG1E,OAAO,CAACgE,SAAR,CAAkBC,KAAK,KAAK9D,SAAV,GAAsB,CAAtB,GAA0B8D,KAAK,GAAG,CAApD,CAAZ;AACA,MAAIiB,OAAO,GAAG,EAAd;AACAR,EAAAA,KAAK,CAACnB,OAAN,CAAc,UAAU4B,GAAV,EAAe;AAEzBD,IAAAA,OAAO,CAAC/C,IAAR,CAAa,CAACgD,GAAG,CAAC,CAAD,CAAH,GAAS,MAAT,GAAkB,EAAnB,IAAyBA,GAAG,CAAC,CAAD,CAA5B,GAAkC,IAAlC,GAAyCA,GAAG,CAAC,CAAD,CAA5C,GAAkD,GAAlD,GAAwDA,GAAG,CAAC,CAAD,CAA3D,GAAiE,GAAjE,GAAuEA,GAAG,CAAC,CAAD,CAA1E,GAAgF,GAA7F;AACH,GAHD;AAKA,SAAOD,OAAP;AACH,CAVD;;AAaAlF,OAAO,CAACoF,KAAR,GAAgB,UAAUC,OAAV,EAAmB;AAE/B,MAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,MAA7B,EAAqC;AACjC,UAAM,IAAIrB,KAAJ,CAAUkB,OAAO,IAAI,eAArB,CAAN;AACH,GAFD,MAGK;AACDI,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAYL,OAAZ,GAAsB,MAAtB,GAA+BrF,OAAO,CAACiF,YAAR,CAAqB,CAArB,EAAwBU,IAAxB,CAA6B,MAA7B,CAA3C;AACAL,IAAAA,OAAO,CAACM,IAAR,CAAa,CAAb;AACH;AACJ,CATD;;AAYA5F,OAAO,CAAC6F,MAAR,GAAiB,UAAUC,SAAV,EAAqBT,OAArB,EAA8B;AAE3C,MAAI,CAACS,SAAL,EAAgB;AACZ9F,IAAAA,OAAO,CAACoF,KAAR,CAAcC,OAAd;AACH;AACJ,CALD;;AAQArF,OAAO,CAAC+F,cAAR,GAAyB,UAAU3C,IAAV,EAAgB4C,YAAhB,EAA8B9E,MAA9B,EAAsC;AAAO;AAElE,MAAI+E,OAAO,GAAG,EAAd;;AACA,OAAK,IAAI3F,CAAC,GAAG,CAAR,EAAW0B,EAAE,GAAGgE,YAAY,CAAC/D,MAAlC,EAA0C3B,CAAC,GAAG0B,EAA9C,EAAkD,EAAE1B,CAApD,EAAuD;AACnD2F,IAAAA,OAAO,CAACD,YAAY,CAAC1F,CAAD,CAAZ,GAAkB,KAAnB,CAAP,GAAmC,IAAnC;AACH;;AAEDT,EAAAA,EAAE,CAACqG,WAAH,CAAe9C,IAAf,EAAqBG,OAArB,CAA6B,UAAU4C,QAAV,EAAoB;AAE7C,QAAI,QAAQC,IAAR,CAAaD,QAAb,KACA,CAACF,OAAO,CAACE,QAAD,CADZ,EACwB;AAEpB,UAAIE,IAAI,GAAGF,QAAQ,CAACG,MAAT,CAAgB,CAAhB,EAAmBH,QAAQ,CAACI,WAAT,CAAqB,GAArB,CAAnB,CAAX;AACA,UAAIC,OAAO,GAAGH,IAAI,CAACI,MAAL,CAAY,CAAZ,EAAeC,WAAf,KAA+BL,IAAI,CAACC,MAAL,CAAY,CAAZ,EAAeK,WAAf,EAA7C;;AAEA,UAAI,OAAOzF,MAAP,KAAkB,UAAtB,EAAkC;AAC9BA,QAAAA,MAAM,CAACsF,OAAD,CAAN,GAAkB1G,OAAO,CAACsD,IAAI,GAAG,GAAP,GAAaiD,IAAd,CAAzB;AACH,OAFD,MAGK;AACDnF,QAAAA,MAAM,CAACkC,IAAI,GAAG,GAAP,GAAaiD,IAAd,EAAoBA,IAApB,EAA0BG,OAA1B,CAAN;AACH;AACJ;AACJ,GAfD;AAgBH,CAvBD;;AA0BAxG,OAAO,CAAC4G,MAAR,GAAiB,UAAU1G,GAAV,EAAe2G,IAAf,EAAqBC,EAArB,EAAyB;AAEtC5G,EAAAA,GAAG,CAAC4G,EAAD,CAAH,GAAU5G,GAAG,CAAC2G,IAAD,CAAb;AACA,SAAO3G,GAAG,CAAC2G,IAAD,CAAV;AACH,CAJD;;AAOA7G,OAAO,CAAC+G,KAAR,GAAgB,YAAY;AAExB,OAAKC,KAAL;AACH,CAHD;;AAMAhH,OAAO,CAAC+G,KAAR,CAAcnD,SAAd,CAAwBoD,KAAxB,GAAgC,YAAY;AAExC,OAAKC,EAAL,GAAUzG,IAAI,CAAC0G,GAAL,EAAV;AACH,CAHD;;AAMAlH,OAAO,CAAC+G,KAAR,CAAcnD,SAAd,CAAwBuD,OAAxB,GAAkC,YAAY;AAE1C,SAAO3G,IAAI,CAAC0G,GAAL,KAAa,KAAKD,EAAzB;AACH,CAHD,C,CAMA;;;AAEAjH,OAAO,CAACoH,WAAR,GAAsB,UAAUC,GAAV,EAAe;AAEjC,MAAItF,MAAM,GAAG,EAAb;AACA,MAAIuF,QAAQ,GAAG,CAACD,GAAG,IAAI/B,OAAO,CAACC,GAAR,CAAYgC,GAApB,IAA2B,eAA1C;;AACA,MAAI1H,EAAE,CAAC2H,UAAH,CAAcF,QAAd,CAAJ,EAA6B;AACzB,QAAI;AACAvF,MAAAA,MAAM,GAAG0F,IAAI,CAACC,KAAL,CAAW7H,EAAE,CAAC8H,YAAH,CAAgBL,QAAhB,CAAX,CAAT;AACH,KAFD,CAGA,OAAOM,CAAP,EAAU,CAAG;AAChB;;AAED,SAAO7F,MAAP;AACH,CAZD,C,CAeA;;;AAEA/B,OAAO,CAAC6H,WAAR,GAAsB,UAAUC,MAAV,EAAkB;AAEpC;AACA,SAAOA,MAAM,CAACC,OAAP,CAAe,6CAAf,EAA8D,MAA9D,CAAP;AACH,CAJD,C,CAOA;;;AAEA/H,OAAO,CAACgI,IAAR,GAAe,UAAUlC;AAAU;AAApB,EAAgD;AAE3D,MAAIT,OAAO,GAAIb,SAAS,CAACvC,MAAV,KAAqB,CAArB,GAAyBuC,SAAS,CAAC,CAAD,CAAlC,GAAwC,EAAvD;AACA,MAAIV,QAAQ,GAAIU,SAAS,CAACvC,MAAV,KAAqB,CAArB,GAAyBuC,SAAS,CAAC,CAAD,CAAlC,GAAwCA,SAAS,CAAC,CAAD,CAAjE;AAEA,MAAIT,GAAG,GAAIsB,OAAO,YAAYlB,KAAnB,GAA2BkB,OAA3B,GAAsCA,OAAO,GAAG,IAAIlB,KAAJ,CAAUkB,OAAV,CAAH,GAAyBS,SAAS,YAAY3B,KAArB,GAA6B2B,SAA7B,GAAyC,IAAI3B,KAAJ,EAA1H;;AAEA,MAAI2B,SAAS,YAAY3B,KAArB,IACA,CAAC2B,SADL,EACgB;AAEZ,WAAOhC,QAAQ,CAACC,GAAD,CAAf;AACH;AACJ,CAZD,C,CAeA;;;AAEA/D,OAAO,CAACiI,eAAR,GAA0B,UAAU1G,KAAV,EAAiB;AAEvC,SAAQ,IAAI2G,MAAJ,CAAW3G,KAAX,EAAkB,QAAlB,CAAD,CAA8B4G,QAA9B,CAAuC,QAAvC,EAAiDJ,OAAjD,CAAyD,KAAzD,EAAgE,GAAhE,EAAqEA,OAArE,CAA6E,KAA7E,EAAoF,GAApF,EAAyFA,OAAzF,CAAiG,KAAjG,EAAwG,EAAxG,CAAP;AACH,CAHD,C,CAMA;;;AAEA/H,OAAO,CAACoI,eAAR,GAA0B,UAAUC,OAAV,EAAmB;AAEzC,MAAIA,OAAO,IACP,CAACA,OAAO,CAACC,KAAR,CAAc,WAAd,CADL,EACiC;AAE7B,WAAO,IAAInE,KAAJ,CAAU,mBAAV,CAAP;AACH;;AAED,MAAI;AACA,WAAQ,IAAI+D,MAAJ,CAAWG,OAAO,CAACN,OAAR,CAAgB,IAAhB,EAAsB,GAAtB,EAA2BA,OAA3B,CAAmC,IAAnC,EAAyC,GAAzC,CAAX,EAA0D,QAA1D,CAAD,CAAsEI,QAAtE,CAA+E,QAA/E,CAAP;AACH,GAFD,CAGA,OAAOpE,GAAP,EAAY;AACR,WAAOA,GAAP;AACH;AACJ,CAdD,C,CAiBA;;;AAEA/D,OAAO,CAACuI,qBAAR,GAAgC,UAAUC,SAAV,EAAqB;AAEjD,SAAOA,SAAS,CAACT,OAAV,CAAkB,KAAlB,EAAyB,MAAzB,EAAiCA,OAAjC,CAAyC,KAAzC,EAAgD,KAAhD,CAAP;AACH,CAHD,C,CAMA;;;AAEAhI,SAAS,CAAC0I,WAAV,GAAwB;AACpB,OAAK,OADe;AAEpB,OAAK,MAFe;AAGpB,OAAK,MAHe;AAIpB,OAAK,QAJe;AAKpB,OAAK,QALe;AAMpB,OAAK;AANe,CAAxB;;AASAzI,OAAO,CAAC0I,UAAR,GAAqB,UAAUZ,MAAV,EAAkB;AAEnC,MAAI,CAACA,MAAL,EAAa;AACT,WAAO,EAAP;AACH;;AAED,MAAI,WAAW1B,IAAX,CAAgB0B,MAAhB,MAA4B,KAAhC,EAAuC;AACnC,WAAOA,MAAP;AACH;;AAED,SAAOA,MAAM,CAACC,OAAP,CAAe,WAAf,EAA4B,UAAUY,GAAV,EAAe;AAE9C,WAAO5I,SAAS,CAAC0I,WAAV,CAAsBE,GAAtB,CAAP;AACH,GAHM,CAAP;AAIH,CAdD","sourcesContent":["// Load modules\r\n\r\nvar Fs = require('fs');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {};\r\n\r\n\r\n// Clone object or array\r\n\r\nexports.clone = function (obj) {\r\n\r\n    if (obj === null ||\r\n        obj === undefined) {\r\n\r\n        return null;\r\n    }\r\n\r\n    var newObj = (obj instanceof Array) ? [] : {};\r\n\r\n    for (var i in obj) {\r\n        if (obj.hasOwnProperty(i)) {\r\n            if (obj[i] instanceof Date) {\r\n                newObj[i] = new Date(obj[i].getTime());\r\n            }\r\n            else if (obj[i] instanceof RegExp) {\r\n                var flags = '' + (obj[i].global ? 'g' : '') + (obj[i].ignoreCase ? 'i' : '') + (obj[i].multiline ? 'm' : '') + (obj[i].sticky ? 'y' : '');\r\n                newObj[i] = new RegExp(obj[i].source, flags);\r\n            }\r\n            else if (typeof obj[i] === 'object') {\r\n                newObj[i] = exports.clone(obj[i]);\r\n            }\r\n            else {\r\n                newObj[i] = obj[i];\r\n            }\r\n        }\r\n    }\r\n\r\n    return newObj;\r\n};\r\n\r\n\r\n// Merge all the properties of source into target, source wins in conflic, and by default null and undefined from source are applied\r\n\r\nexports.merge = function (target, source, isNullOverride /* = true */, isMergeArrays /* = true */) {\r\n\r\n    if (source) {\r\n        if (source instanceof Array) {\r\n            if (isMergeArrays !== false) {                                      // Defaults to true\r\n                target = (target || []).concat(source);\r\n            }\r\n            else {\r\n                target = source;\r\n            }\r\n        }\r\n        else {\r\n            target = target || {};\r\n\r\n            for (var key in source) {\r\n                if (source.hasOwnProperty(key)) {\r\n                    var value = source[key];\r\n\r\n                    if (value &&\r\n                        typeof value === 'object') {\r\n\r\n                        if (value instanceof Date) {\r\n                            target[key] = new Date(value.getTime());\r\n                        }\r\n                        else if (value instanceof RegExp) {\r\n                            var flags = '' + (value.global ? 'g' : '') + (value.ignoreCase ? 'i' : '') + (value.multiline ? 'm' : '') + (value.sticky ? 'y' : '');\r\n                            target[key] = new RegExp(value.source, flags);\r\n                        }\r\n                        else {\r\n                            target[key] = exports.merge(target[key], source[key], isNullOverride, isMergeArrays);\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (value !== null && value !== undefined) {            // Explicit to preserve empty strings\r\n                            target[key] = value;\r\n                        }\r\n                        else if (isNullOverride !== false) {                    // Defaults to true\r\n                            target[key] = value;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return target;\r\n};\r\n\r\n\r\n// Apply options to a copy of the defaults\r\n\r\nexports.applyToDefaults = function (defaults, options) {\r\n\r\n    if (!options) {                                                 // If no options, return null\r\n        return null;\r\n    }\r\n\r\n    var copy = exports.clone(defaults);\r\n\r\n    if (options === true) {                                         // If options is set to true, use defaults\r\n        return copy;\r\n    }\r\n\r\n    return exports.merge(copy, options, false, false);\r\n};\r\n\r\n\r\n// Remove duplicate items from array\r\n\r\nexports.unique = function (array, key) {\r\n\r\n    var index = {};\r\n    var result = [];\r\n\r\n    for (var i = 0, il = array.length; i < il; ++i) {\r\n        var id = (key ? array[i][key] : array[i]);\r\n        if (index[id] !== true) {\r\n\r\n            result.push(array[i]);\r\n            index[id] = true;\r\n        }\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\n\r\n// Convert array into object\r\n\r\nexports.mapToObject = function (array, key) {\r\n\r\n    if (!array) {\r\n        return null;\r\n    }\r\n\r\n    var obj = {};\r\n    for (var i = 0, il = array.length; i < il; ++i) {\r\n        if (key) {\r\n            if (array[i][key]) {\r\n                obj[array[i][key]] = true;\r\n            }\r\n        }\r\n        else {\r\n            obj[array[i]] = true;\r\n        }\r\n    }\r\n\r\n    return obj;\r\n};\r\n\r\n\r\n// Find the common unique items in two arrays\r\n\r\nexports.intersect = function (array1, array2) {\r\n\r\n    if (!array1 || !array2) {\r\n        return [];\r\n    }\r\n\r\n    var common = [];\r\n    var hash = exports.mapToObject(array1);\r\n    var found = {};\r\n    for (var i = 0, il = array2.length; i < il; ++i) {\r\n        if (hash[array2[i]] && !found[array2[i]]) {\r\n            common.push(array2[i]);\r\n            found[array2[i]] = true;\r\n        }\r\n    }\r\n\r\n    return common;\r\n};\r\n\r\n\r\n// Find which keys are present\r\n\r\nexports.matchKeys = function (obj, keys) {\r\n\r\n    var matched = [];\r\n    for (var i = 0, il = keys.length; i < il; ++i) {\r\n        if (obj.hasOwnProperty(keys[i])) {\r\n            matched.push(keys[i]);\r\n        }\r\n    }\r\n    return matched;\r\n};\r\n\r\n\r\n// Flatten array\r\n\r\nexports.flatten = function (array, target) {\r\n\r\n    var result = target || [];\r\n\r\n    for (var i = 0, il = array.length; i < il; ++i) {\r\n        if (Array.isArray(array[i])) {\r\n            exports.flatten(array[i], result);\r\n        }\r\n        else {\r\n            result.push(array[i]);\r\n        }\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\n\r\n// Remove keys\r\n\r\nexports.removeKeys = function (object, keys) {\r\n\r\n    for (var i = 0, il = keys.length; i < il; i++) {\r\n        delete object[keys[i]];\r\n    }\r\n};\r\n\r\n\r\n// Convert an object key chain string ('a.b.c') to reference (object[a][b][c])\r\n\r\nexports.reach = function (obj, chain) {\r\n\r\n    var path = chain.split('.');\r\n    var ref = obj;\r\n    path.forEach(function (level) {\r\n\r\n        if (ref) {\r\n            ref = ref[level];\r\n        }\r\n    });\r\n\r\n    return ref;\r\n};\r\n\r\n\r\n// Inherits a selected set of methods from an object, wrapping functions in asynchronous syntax and catching errors\r\n\r\nexports.inheritAsync = function (self, obj, keys) {\r\n\r\n    keys = keys || null;\r\n\r\n    for (var i in obj) {\r\n        if (obj.hasOwnProperty(i)) {\r\n            if (keys instanceof Array &&\r\n                keys.indexOf(i) < 0) {\r\n\r\n                continue;\r\n            }\r\n\r\n            self.prototype[i] = (function (fn) {\r\n\r\n                return function (callback) {\r\n\r\n                    var result = null;\r\n                    try {\r\n                        result = fn();\r\n                    }\r\n                    catch (err) {\r\n                        return callback(err);\r\n                    }\r\n\r\n                    return callback(null, result);\r\n                };\r\n            })(obj[i]);\r\n        }\r\n    }\r\n};\r\n\r\n\r\nexports.callStack = function (slice) {\r\n\r\n    // http://code.google.com/p/v8/wiki/JavaScriptStackTraceApi\r\n\r\n    var v8 = Error.prepareStackTrace;\r\n    Error.prepareStackTrace = function (err, stack) {\r\n\r\n        return stack;\r\n    };\r\n\r\n    var capture = {};\r\n    Error.captureStackTrace(capture, arguments.callee);\r\n    var stack = capture.stack;\r\n\r\n    Error.prepareStackTrace = v8;\r\n\r\n    var trace = [];\r\n    stack.forEach(function (item) {\r\n\r\n        trace.push([item.getFileName(), item.getLineNumber(), item.getColumnNumber(), item.getFunctionName(), item.isConstructor()]);\r\n    });\r\n\r\n    if (slice) {\r\n        return trace.slice(slice);\r\n    }\r\n\r\n    return trace;\r\n};\r\n\r\n\r\nexports.displayStack = function (slice) {\r\n\r\n    var trace = exports.callStack(slice === undefined ? 1 : slice + 1);\r\n    var display = [];\r\n    trace.forEach(function (row) {\r\n\r\n        display.push((row[4] ? 'new ' : '') + row[3] + ' (' + row[0] + ':' + row[1] + ':' + row[2] + ')');\r\n    });\r\n\r\n    return display;\r\n};\r\n\r\n\r\nexports.abort = function (message) {\r\n\r\n    if (process.env.NODE_ENV === 'test') {\r\n        throw new Error(message || 'Unknown error');\r\n    }\r\n    else {\r\n        console.log('ABORT: ' + message + '\\n\\t' + exports.displayStack(1).join('\\n\\t'));\r\n        process.exit(1);\r\n    }\r\n};\r\n\r\n\r\nexports.assert = function (condition, message) {\r\n\r\n    if (!condition) {\r\n        exports.abort(message);\r\n    }\r\n};\r\n\r\n\r\nexports.loadDirModules = function (path, excludeFiles, target) {      // target(filename, name, capName)\r\n\r\n    var exclude = {};\r\n    for (var i = 0, il = excludeFiles.length; i < il; ++i) {\r\n        exclude[excludeFiles[i] + '.js'] = true;\r\n    }\r\n\r\n    Fs.readdirSync(path).forEach(function (filename) {\r\n\r\n        if (/\\.js$/.test(filename) &&\r\n            !exclude[filename]) {\r\n\r\n            var name = filename.substr(0, filename.lastIndexOf('.'));\r\n            var capName = name.charAt(0).toUpperCase() + name.substr(1).toLowerCase();\r\n\r\n            if (typeof target !== 'function') {\r\n                target[capName] = require(path + '/' + name);\r\n            }\r\n            else {\r\n                target(path + '/' + name, name, capName);\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n\r\nexports.rename = function (obj, from, to) {\r\n\r\n    obj[to] = obj[from];\r\n    delete obj[from];\r\n};\r\n\r\n\r\nexports.Timer = function () {\r\n\r\n    this.reset();\r\n};\r\n\r\n\r\nexports.Timer.prototype.reset = function () {\r\n\r\n    this.ts = Date.now();\r\n};\r\n\r\n\r\nexports.Timer.prototype.elapsed = function () {\r\n\r\n    return Date.now() - this.ts;\r\n};\r\n\r\n\r\n// Load and parse package.json process root or given directory\r\n\r\nexports.loadPackage = function (dir) {\r\n\r\n    var result = {};\r\n    var filepath = (dir || process.env.PWD) + '/package.json';\r\n    if (Fs.existsSync(filepath)) {\r\n        try {\r\n            result = JSON.parse(Fs.readFileSync(filepath));\r\n        }\r\n        catch (e) { }\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\n\r\n// Escape string for Regex construction\r\n\r\nexports.escapeRegex = function (string) {\r\n\r\n    // Escape ^$.*+-?=!:|\\/()[]{},\r\n    return string.replace(/[\\^\\$\\.\\*\\+\\-\\?\\=\\!\\:\\|\\\\\\/\\(\\)\\[\\]\\{\\}\\,]/g, '\\\\$&');\r\n};\r\n\r\n\r\n// Return an error as first argument of a callback\r\n\r\nexports.toss = function (condition /*, [message], callback */) {\r\n\r\n    var message = (arguments.length === 3 ? arguments[1] : '');\r\n    var callback = (arguments.length === 3 ? arguments[2] : arguments[1]);\r\n\r\n    var err = (message instanceof Error ? message : (message ? new Error(message) : (condition instanceof Error ? condition : new Error())));\r\n\r\n    if (condition instanceof Error ||\r\n        !condition) {\r\n\r\n        return callback(err);\r\n    }\r\n};\r\n\r\n\r\n// Base64url (RFC 4648) encode\r\n\r\nexports.base64urlEncode = function (value) {\r\n\r\n    return (new Buffer(value, 'binary')).toString('base64').replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\r\n};\r\n\r\n\r\n// Base64url (RFC 4648) decode\r\n\r\nexports.base64urlDecode = function (encoded) {\r\n\r\n    if (encoded &&\r\n        !encoded.match(/^[\\w\\-]*$/)) {\r\n\r\n        return new Error('Invalid character');\r\n    }\r\n\r\n    try {\r\n        return (new Buffer(encoded.replace(/-/g, '+').replace(/:/g, '/'), 'base64')).toString('binary');\r\n    }\r\n    catch (err) {\r\n        return err;\r\n    }\r\n};\r\n\r\n\r\n// Escape attribute value for use in HTTP header\r\n\r\nexports.escapeHeaderAttribute = function (attribute) {\r\n\r\n    return attribute.replace(/\\\\/g, '\\\\\\\\').replace(/\\\"/g, '\\\\\"');\r\n};\r\n\r\n\r\n// Escape string for inclusion in HTML\r\n\r\ninternals.htmlEscaped = {\r\n    '&': '&amp;',\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '\"': '&quot;',\r\n    \"'\": '&#x27;',\r\n    '`': '&#x60;'\r\n};\r\n\r\nexports.escapeHtml = function (string) {\r\n\r\n    if (!string) {\r\n        return '';\r\n    }\r\n\r\n    if (/[&<>\"'`]/.test(string) === false) {\r\n        return string;\r\n    }\r\n\r\n    return string.replace(/[&<>\"'`]/g, function (chr) {\r\n\r\n        return internals.htmlEscaped[chr];\r\n    });\r\n};\r\n"]},"metadata":{},"sourceType":"script"}