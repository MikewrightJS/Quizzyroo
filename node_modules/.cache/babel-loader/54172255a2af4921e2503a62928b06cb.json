{"ast":null,"code":"// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE\nvar dgram = require('dgram'),\n    EventEmitter = require('events').EventEmitter,\n    net = require('net'),\n    util = require('util');\n\nvar is_absolute = exports.is_absolute = function (f) {\n  return f && /\\.$/.test(f);\n};\n\nvar ensure_absolute = exports.ensure_absolute = function (f) {\n  if (!is_absolute(f)) return f += '.';\n  return f;\n};\n\nvar CNAME = require('native-dns-packet').consts.NAME_TO_QTYPE.CNAME;\n\nvar Lookup = exports.Lookup = function (store, zone, question, cb) {\n  if (!(this instanceof Lookup)) return new Lookup(store, zone, question, cb);\n  this.store = store;\n  this.zone = zone;\n  this.cb = cb;\n  this.question = question;\n  this.results = [];\n  this.wildcard = undefined;\n  this.name = ensure_absolute(question.name);\n  this.store.get(this.zone, this.name, this.lookup.bind(this));\n};\n\nLookup.prototype.send = function (err) {\n  this.cb(err, this.results);\n};\n\nLookup.prototype.lookup = function (err, results) {\n  var type,\n      ret,\n      name,\n      self = this;\n  if (err) return this.send(err);\n\n  if (!results) {\n    if (!this.wildcard) this.wildcard = this.question.name;\n    if (this.wildcard.toLowerCase() == this.zone.toLowerCase()) return this.send();\n    name = this.wildcard = this.wildcard.split('.').splice(1).join('.'); // 'com.'.split('.').splice(1) will return empty string, we're at the end\n\n    if (!this.wildcard) return this.send();\n    name = '*.' + name;\n  } else if (results[this.question.type]) {\n    type = this.question.type;\n    ret = results;\n  } else if (results[CNAME]) {\n    type = CNAME;\n    ret = results;\n    this.name = name = results[CNAME][0].data;\n  }\n\n  if (ret) {\n    ret = ret[type];\n    ret.forEach(function (r) {\n      var rr, k;\n\n      if (self.wildcard && /^\\*/.test(r.name)) {\n        rr = {};\n\n        for (k in r) {\n          rr[k] = r[k];\n        }\n\n        rr.name = self.name;\n      } else {\n        rr = r;\n      }\n\n      self.results.push(rr);\n    });\n  }\n\n  if (name) this.store.get(this.zone, ensure_absolute(name), this.lookup.bind(this));else this.send();\n};","map":{"version":3,"sources":["C:/react/quiz/node_modules/native-dns-cache/lookup.js"],"names":["dgram","require","EventEmitter","net","util","is_absolute","exports","f","test","ensure_absolute","CNAME","consts","NAME_TO_QTYPE","Lookup","store","zone","question","cb","results","wildcard","undefined","name","get","lookup","bind","prototype","send","err","type","ret","self","toLowerCase","split","splice","join","data","forEach","r","rr","k","push"],"mappings":"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","sourcesContent":["// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE\n\nvar dgram = require('dgram'),\n    EventEmitter = require('events').EventEmitter,\n    net = require('net'),\n    util = require('util');\n\nvar is_absolute = exports.is_absolute = function (f) {\n  return f && /\\.$/.test(f);\n};\n\nvar ensure_absolute = exports.ensure_absolute = function (f) {\n  if (!is_absolute(f))\n    return f += '.';\n  return f;\n};\n\nvar CNAME = require('native-dns-packet').consts.NAME_TO_QTYPE.CNAME;\n\nvar Lookup = exports.Lookup = function (store, zone, question, cb) {\n  if (!(this instanceof Lookup))\n    return new Lookup(store, zone, question, cb);\n\n  this.store = store;\n  this.zone = zone;\n  this.cb = cb;\n  this.question = question;\n  this.results = [];\n  this.wildcard = undefined;\n\n  this.name = ensure_absolute(question.name);\n\n  this.store.get(this.zone, this.name, this.lookup.bind(this));\n};\n\nLookup.prototype.send = function (err) {\n  this.cb(err, this.results);\n};\n\nLookup.prototype.lookup = function (err, results) {\n  var type, ret, name, self = this;\n\n  if (err)\n    return this.send(err);\n\n  if (!results) {\n    if (!this.wildcard)\n      this.wildcard = this.question.name;\n\n    if (this.wildcard.toLowerCase() == this.zone.toLowerCase())\n      return this.send();\n\n    name = this.wildcard = this.wildcard.split('.').splice(1).join('.');\n\n    // 'com.'.split('.').splice(1) will return empty string, we're at the end\n    if (!this.wildcard)\n      return this.send();\n\n    name = '*.' + name;\n  } else if (results[this.question.type]) {\n    type = this.question.type;\n    ret = results;\n  } else if (results[CNAME]) {\n    type = CNAME;\n    ret = results;\n    this.name = name = results[CNAME][0].data\n  }\n\n  if (ret) {\n    ret = ret[type];\n    ret.forEach(function (r) {\n      var rr, k;\n\n      if (self.wildcard && /^\\*/.test(r.name)) {\n        rr = {};\n        for (k in r) {\n          rr[k] = r[k];\n        }\n        rr.name = self.name;\n      } else {\n        rr = r;\n      }\n\n      self.results.push(rr);\n    });\n  }\n\n  if (name)\n    this.store.get(this.zone, ensure_absolute(name), this.lookup.bind(this));\n  else\n    this.send();\n};\n"]},"metadata":{},"sourceType":"script"}